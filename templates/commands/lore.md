---
description: 将创意转化为世界观与人物档案。
scripts:
  sh: scripts/bash/setup-lore.sh --json
  ps: scripts/powershell/setup-lore.ps1 -Json
---

默认使用中文与用户沟通，并在写入文件时以中文记录非代码内容，除非用户明确要求其他语言。

执行 `/lore` 时请遵循：

1. 运行 `{SCRIPT}`，读取 JSON 以获取 `WORLD_FILE`、`CHARACTERS_DIR`、`CHARACTER_TEMPLATE`、`ROSTER_FILE`，以及 `LOG_FILE`、`PENDING_FILE`。
2. 仅把以下文档视为上一阶段的已确认基石：`ideas/` 中最新的创意基石（`session-*.md`）、现有 `WORLD_FILE`、`CHARACTERS_DIR` 内的角色档案、`project_overview.md`（若已存在）。对话日志与 `PENDING_FILE` 仅用于追溯来源，切勿将其内容当作事实写入正稿。
3. 参考这些基石文件，确保设定连贯；随后以 `#### [LOG#YYYYMMDD-XX] 角色` 形式把本轮发言原文追加到 `LOG_FILE`，可在行尾标注 `#问题`、`#确认` 等标签，严禁修改既有日志。
4. 在 `PENDING_FILE` 中维护所有未确认的设定、疑问和行动项，使用 `[ ]` 复选框，并附带来源 `LOG#`。仅在作者确认后勾选并转入正式档案。
5. 仅记录已获确认的内容，并将其与既有资料融合为最新权威版本：
   - 更新 `WORLD_FILE` 时，根据模板结构重写相关段落，若新结论与旧信息冲突，应以新结论替换旧内容，并在行尾注明 `(引用 LOG#20250924-03)`；
   - `## 待补充问题` 中保留仍未确认的条目，并附对应的 `LOG#`；
   - 同步在 `## 决策索引` 中列出本次确认的要点，便于回溯。
6. 针对每位重要角色：
   - 若无档案，按模板在 `CHARACTERS_DIR` 创建 Markdown；
   - 更新已有档案时，重读整份文件，按章节融合最新结论，替换冲突信息并附 `(引用 LOG#...)`；
   - 在“连续性记录”表追加确认后的剧情摘要，忽略尚未确认的草稿；
   - 更新 `roster.md`，仅写入已确认的身份状态。
7. 用中文向用户汇报本次确认内容与仍待确认事项，明确 `PENDING_FILE` 中仍悬而未决的条目，并逐条等待用户回应，不得自行代答。
8. 在用户显式输入新的 slash 命令（如 `/weave`）之前，始终停留在 `/lore` 模式：不触发其他脚本，不跳转到写作或改稿。

若发现矛盾或信息缺口，请显式标注并提出建议，避免信息割裂。
