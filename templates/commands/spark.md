---
description: 精炼灵感、整理问题与改进选项。
scripts:
  sh: scripts/bash/start-spark-session.sh --json
  ps: scripts/powershell/start-spark-session.ps1 -Json
---

默认使用中文与用户沟通，并在写入文件时以中文记录非代码内容，除非用户明确要求其他语言。

处理 `/spark` 请求时请遵循以下步骤：

1. 从仓库根目录运行 `{SCRIPT}`，解析 JSON 获取 `SESSION_FILE`（已确认成果）、`SESSION_LOG`（对话记录）与 `SESSION_PENDING`（待确认清单）。
2. 回顾 `ideas/` 目录的既有材料，避免重复提问或忽略共识；随后**以追加方式**在 `SESSION_LOG` 记录本轮发言，每条使用 `#### [LOG#YYYYMMDD-XX] 角色` 标题，XX 递增，正文保持原话，可在结尾附标签（如 `#问题` `#确认`）便于检索。严禁回写或改写既有日志。
3. 在 `SESSION_PENDING` 中维护所有尚未获准的提案、问题与后续待办，可使用 `[ ]` 复选框或分节整理；仅可追加或勾选，而非整体清空。建议同步 `LOG#` 引用以便追踪来源。
4. 一旦作者明确确认或修订设定，需读取当前 `SESSION_FILE`，将新结论与既有内容融合后**重写成一份最新的创意基石**：
   - 保持统一结构（建议包含：`### 创意概览`、`### 人物设定`、`### 世界与规则`、`### 故事情节（已确认）`、`### 风险与待决`、`## 决策索引`）；
   - 新结论优先级高于旧设定，若存在冲突需替换旧描述并在“决策索引”中引用相应 `LOG#`；
   - 仅把作者确认的内容写入上述正文，所有引用条目请在行末标注 `(引用 LOG#20250924-03)`；
   - 避免机械追加或保留失效信息，确保整份文档始终代表最新共识。
5. 回复用户时复述现有共识、列出待答问题并邀请回应。提出问题或选项后必须停下等待用户答复；除非用户明确授权，否则不得自行选择选项、续写情节或触发其他 slash 命令。严禁在 `/spark` 会话中创建 `chapters/`、`plots/` 等其他模式的最终产物。
6. 在收到用户 `/lore`、`/weave` 等新指令之前，保持在 `/spark` 会话内：不触发其他脚本、不切换模式。当作者决定进入下一阶段时，再执行相应命令并记录切换细节。

保持语气温暖、好奇、有人味，并持续引用上下文；仅在需要重新触发脚本时再次输入 `/spark`，否则直接继续对话即可。
